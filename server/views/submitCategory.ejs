<!DOCTYPE html>
<html lang="en">
<head>

    <title>Create Category - thunk.space</title>
  
    <%- include('includes/header') %>


    <script>
      function generateCategoryPermalink() {
          const title = document.getElementById('suggestedPermalink').value;
          const basePath = "";
          const cleanedTitle = title
              .replace(/[^\w\s]/gi, '') // Remove non-alphanumeric characters except spaces
              .trim() // Remove leading and trailing spaces
              .replace(/\s+/g, '-') // Replace spaces with hyphens
              .toLowerCase(); // Convert to lowercase

          const truncatedTitle = cleanedTitle.substring(0, 147); // Truncate to 147 characters to leave room for "/c/"
          const permalink = basePath + truncatedTitle;

          document.getElementById('displayPermalink').textContent = `${permalink}`;
          // Update hidden input to send to server
          document.getElementById('finalPermalink').value = permalink;
      }
  </script>
</head>
<body class="submitCategoryPage">
  <div class="container">
    <a href="/"><img id="logo_satori1" src="branding/thunk1b.png" /></a>
    <div class="submission-form">
        <form action="/submitCategory" method="POST">
            <h2>Create a new category</h2>

            <input type="text" id="categoryName" name="name" placeholder="Enter category name" required>

            <input type="text" id="suggestedPermalink" name="suggestedPermalink" placeholder="Enter a link" oninput="generateCategoryPermalink()" required>
            
            <p id="displayPermalink">/c/</p>
            <input type="hidden" id="finalPermalink" name="permalink">

            <div id="categoryDescription" class="contentField">
                <textarea id="categoryDescText" name="description" placeholder="Describe the category (optional)"></textarea>
            </div>

            <!--
            <label for="categoryModerators">Moderators:</label>
            <input type="text" id="categoryModerators" name="moderators" placeholder="Enter moderator usernames, separated by commas">
            -->
            <button type="submit" id="create_category_submit_button">Create Category</button>
        </form>
    </div>
</div>

    <script>
      new Quill('#categoryDescription', {
          modules: {
              toolbar: [
                  ['bold', 'italic', 'underline', 'strike'],        // formatting options
                  [{ 'list': 'ordered' }, { 'list': 'bullet' }],    // lists
                  ['link']                                          // links
              ]
          },
          theme: 'snow', // Specify theme in configuration
          placeholder: 'Describe the category (optional)',
      });
    </script>
</body>
</html>
